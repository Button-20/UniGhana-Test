{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/SoundIt/Desktop/Development/unighana-test/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"ngx-toastr\";\nexport class AuthService {\n  constructor(http, toastr) {\n    this.http = http;\n    this.toastr = toastr;\n    this.BaseURL = 'http://localhost:4000/api/';\n    this.user = {\n      email: '',\n      password: '',\n      _id: '',\n      username: '',\n      createdAt: '',\n      updatedAt: ''\n    };\n  }\n  login(user) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      return yield new Promise( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (resolve, reject) {\n          try {\n            _this.http.post(_this.BaseURL + 'login', user).subscribe(response => {\n              if (response.message) {\n                _this.toastr.success(response.message);\n                localStorage.setItem('token', response.token);\n              }\n              resolve(response);\n            }, error => {\n              _this.toastr.error(error.error.message);\n              reject(error);\n            });\n          } catch (error) {\n            reject(error);\n          }\n        });\n        return function (_x, _x2) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n  register(user) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      return yield new Promise( /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (resolve, reject) {\n          try {\n            _this2.http.post(_this2.BaseURL + 'register', user).subscribe(response => {\n              if (response.message) {\n                _this2.toastr.success(response.message);\n              }\n              resolve(response);\n            }, error => {\n              _this2.toastr.error(error.error.message);\n              reject(error);\n            });\n          } catch (error) {\n            reject(error);\n          }\n        });\n        return function (_x3, _x4) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n  getUserDetails() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      return yield new Promise( /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator(function* (resolve, reject) {\n          try {\n            _this3.http.get(_this3.BaseURL + 'user').subscribe(response => {\n              _this3.user = response.user;\n              resolve(response);\n            }, error => {\n              _this3.toastr.error(error.error.message);\n              reject(error);\n            });\n          } catch (error) {\n            reject(error);\n          }\n        });\n        return function (_x5, _x6) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n  logout() {\n    localStorage.removeItem('token');\n  }\n  saveToken(token) {\n    crypto.subtle.digest('SHA-256', new TextEncoder().encode(token)).then(hash => {\n      localStorage.setItem('token', btoa(String.fromCharCode(...new Uint8Array(hash))));\n    });\n  }\n}\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.ToastrService));\n};\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["AuthService","constructor","http","toastr","email","password","_id","username","createdAt","updatedAt","login","user","Promise","resolve","reject","post","BaseURL","subscribe","response","message","success","localStorage","setItem","token","error","register","getUserDetails","get","logout","removeItem","saveToken","crypto","subtle","digest","TextEncoder","encode","then","hash","btoa","String","fromCharCode","Uint8Array","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\SoundIt\\Desktop\\Development\\unighana-test\\frontend\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { ToastrService } from 'ngx-toastr';\nimport { User } from '../interfaces/user';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AuthService {\n  BaseURL = 'http://localhost:4000/api/';\n  user: User = {\n    email: '',\n    password: '',\n    _id: '',\n    username: '',\n    createdAt: '',\n    updatedAt: '',\n  };\n\n  constructor(private http: HttpClient, private toastr: ToastrService) {}\n\n  async login(user: User) {\n    return await new Promise(async (resolve, reject) => {\n      try {\n        this.http.post(this.BaseURL + 'login', user).subscribe(\n          (response: any) => {\n            if (response.message) {\n              this.toastr.success(response.message);\n              localStorage.setItem('token', response.token);\n            }\n\n            resolve(response);\n          },\n          (error) => {\n            this.toastr.error(error.error.message);\n            reject(error);\n          }\n        );\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  async register(user: User) {\n    return await new Promise(async (resolve, reject) => {\n      try {\n        this.http.post(this.BaseURL + 'register', user).subscribe(\n          (response: any) => {\n            if (response.message) {\n              this.toastr.success(response.message);\n            }\n            resolve(response);\n          },\n          (error) => {\n            this.toastr.error(error.error.message);\n            reject(error);\n          }\n        );\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  async getUserDetails() {\n    return await new Promise(async (resolve, reject) => {\n      try {\n        this.http.get(this.BaseURL + 'user').subscribe(\n          (response: any) => {\n            this.user = response.user;\n            resolve(response);\n          },\n          (error) => {\n            this.toastr.error(error.error.message);\n            reject(error);\n          }\n        );\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  logout() {\n    localStorage.removeItem('token');\n  }\n\n  saveToken(token: string) {\n    crypto.subtle.digest('SHA-256', new TextEncoder().encode(token)).then(\n      (hash) => {\n        localStorage.setItem('token', btoa(String.fromCharCode(...new Uint8Array(hash))));\n      }\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}